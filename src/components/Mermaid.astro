---
export interface Props {
  code: string;
}

const { code } = Astro.props;
---

<div class="mermaid-container">
  <pre class="mermaid">{code}</pre>
</div>

<script>
  import mermaid from 'mermaid';

  // Initialize mermaid when the component loads
  document.addEventListener('DOMContentLoaded', function () {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose',
      flowchart: {
        htmlLabels: true,
        curve: 'basis'
      }
    });
  });

  // Re-initialize mermaid for dynamic content
  if (typeof window !== 'undefined') {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose',
      flowchart: {
        htmlLabels: true,
        curve: 'basis'
      }
    });
  }
</script>

<style>
  .mermaid-container {
    margin: 2rem 0;
    text-align: center;
  }

  .mermaid {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1rem;
    margin: 1rem 0;
    overflow-x: auto;
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    .mermaid {
      background: #2d3748;
      border-color: #4a5568;
      color: #e2e8f0;
    }
  }
</style>
