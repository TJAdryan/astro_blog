(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&s(g)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const k=300,l=[];let P=1,f="free",I="free",O=1,v=null,c,C=0,R=0,b=0,x=0;function F(e){let n=e;return function(){return n=(n*1664525+1013904223)%2**32,n/2**32}}const d={purchasesByHomeowner:0,purchasesByCorporate:0,purchasesByIndividual:0,convertedToShortTerm:0};function N(){l.length=0;for(let e=0;e<k;e++){let n;e<25?n="corporate":e<105?n="individual":n="homeowner";const a=3e5+c()*2e5;let s=e<3?"ShortTermRental":"LongTermRental";l.push({id:e,ownerType:n,type:"SingleFamily",usage:s,price:a,rent:a*.005})}C=l.filter(e=>e.ownerType==="homeowner").length,R=l.filter(e=>e.ownerType==="individual").length,b=l.filter(e=>e.ownerType==="corporate").length,x=l.filter(e=>e.ownerType!=="homeowner"&&e.usage==="LongTermRental").length}function $(){P++;const e=parseFloat(document.getElementById("turnover-rate-input").value)/100;let n=parseInt(document.getElementById("new-homes-input").value);c()<.2&&(O+=.05);const a=.03*O+(3-n)*.02;l.forEach(t=>{t.price*=1+a,t.ownerType!=="homeowner"&&(t.rent*=1+a)});const s=l.filter(t=>t.ownerType==="corporate"),r=s.length/l.length;if(f==="divest"&&r>.1){const t=s[Math.floor(c()*s.length)];t.ownerType=c()<.7?"individual":"homeowner"}const i=Math.floor(l.length*e);for(let t=0;t<i;t++){const o=Math.floor(c()*l.length),m=l[o],h=c();let u,p=f==="free"||f==="restrict"&&r<.1;p&&h<.6?(u="corporate",d.purchasesByCorporate++):(p?(h-.6)/.4:h)<.625?(u="individual",d.purchasesByIndividual++):(u="homeowner",d.purchasesByHomeowner++),m.ownerType=u}for(let t=0;t<n;t++){const o=l.length,m=4e5+c()*25e4;l.push({id:o,ownerType:null,type:"SingleFamily",usage:"LongTermRental",price:m,rent:m*.005});const h=l[o],u=c();let p,S=f==="free"||f==="restrict"&&r<.1;S&&u<.6?(p="corporate",d.purchasesByCorporate++):(S?(u-.6)/.4:u)<.625?(p="individual",d.purchasesByIndividual++):(p="homeowner",d.purchasesByHomeowner++),h.ownerType=p}I==="ban"&&l.forEach(t=>{t.usage==="ShortTermRental"&&c()<.2&&(t.usage="LongTermRental")});const E=l.filter(t=>t.usage==="ShortTermRental").length/l.length,T=l.filter(t=>t.ownerType!=="homeowner"&&t.usage==="LongTermRental"),B=Math.floor(T.length*.15),y=[...T];for(let t=y.length-1;t>0;t--){const o=Math.floor(c()*(t+1));[y[t],y[o]]=[y[o],y[t]]}if(y.slice(0,B).forEach(t=>{(I==="free"||I==="restrict"&&E<.1)&&c()<.05&&(t.usage="ShortTermRental",d.convertedToShortTerm++)}),f==="free"&&r>.3&&c()<.25){const t=document.getElementById("new-homes-input");parseInt(t.value)>0&&t.value--}H(),A()}const q=["run-simulation-btn","reset-btn","next-year-btn","corp-policy-free","corp-policy-restrict","corp-policy-divest","str-policy-free","str-policy-restrict","str-policy-ban","turnover-rate-input","new-homes-input","years-to-run-input"];function M(e){q.forEach(n=>{document.getElementById(n).disabled=e})}function D(){const e=parseInt(document.getElementById("years-to-run-input").value);if(e<=0||v)return;let n=0;M(!0),v=setInterval(()=>{if(n>=e){clearInterval(v),v=null,M(!1);return}$(),n++},500)}function U(){v&&(clearInterval(v),v=null),c=F(12345),P=1,O=1,f="free",I="free",Object.keys(d).forEach(e=>d[e]=0),document.getElementById("turnover-rate-input").value=4,document.getElementById("new-homes-input").value=3,document.getElementById("years-to-run-input").value=1,document.querySelectorAll(".policy-controls button").forEach(e=>e.classList.remove("active")),document.getElementById("corp-policy-free").classList.add("active"),document.getElementById("str-policy-free").classList.add("active"),M(!1),N(),H(),A()}function H(){const e={homeowner:0,individual:0,corporate:0};l.forEach(o=>{o.ownerType&&e[o.ownerType]++});const n=e.homeowner,a=e.individual,s=e.corporate,r=l.filter(o=>o.ownerType!=="homeowner"&&o.usage==="LongTermRental").length,i=C?(n-C)/C*100:0,g=R?(a-R)/R*100:0,E=b?(s-b)/b*100:0,T=x?(r-x)/x*100:0;document.getElementById("pct-owner-occupied").textContent=(i>=0?"+":"")+i.toFixed(1)+"%",document.getElementById("pct-individual-landlords").textContent=(g>=0?"+":"")+g.toFixed(1)+"%",document.getElementById("pct-corporate-landlords").textContent=(E>=0?"+":"")+E.toFixed(1)+"%",document.getElementById("pct-apartments-available").textContent=(T>=0?"+":"")+T.toFixed(1)+"%",document.getElementById("current-homeowner-total").textContent=e.homeowner,document.getElementById("current-individual-total").textContent=e.individual,document.getElementById("current-corporate-total").textContent=e.corporate;const w=l.map(o=>o.price).sort((o,m)=>o-m),B=Math.floor(w.length/2),y=w.length%2===0?(w[B-1]+w[B])/2:w[B];document.getElementById("median-home-price").textContent=`$${Math.round(y/1e3)}k`;const L=l.filter(o=>o.ownerType!=="homeowner");if(L.length>0){const o=L.map(u=>u.rent).sort((u,p)=>u-p),m=Math.floor(o.length/2),h=o.length%2===0?(o[m-1]+o[m])/2:o[m];document.getElementById("median-rent").textContent=`$${Math.round(h).toLocaleString()}`}else document.getElementById("median-rent").textContent="N/A";const t=L.filter(o=>o.usage==="LongTermRental").length;document.getElementById("available-rental-units").textContent=t,document.getElementById("total-homes").textContent=l.length,document.getElementById("year-display").textContent=P,document.getElementById("buyer-first-time").textContent=d.purchasesByHomeowner,document.getElementById("buyer-corporate").textContent=d.purchasesByCorporate,document.getElementById("buyer-individual").textContent=d.purchasesByIndividual,document.getElementById("conversions-airbnb").textContent=d.convertedToShortTerm}function A(){const e=document.getElementById("housing-visual-grid");e.innerHTML="",l.forEach(n=>{const a=document.createElement("div");a.classList.add("house"),n.usage==="ShortTermRental"?a.classList.add("shortterm"):n.ownerType&&a.classList.add(n.ownerType),e.appendChild(a)})}document.addEventListener("DOMContentLoaded",()=>{c=F(12345),N(),H(),A(),document.getElementById("run-simulation-btn").addEventListener("click",D),document.getElementById("next-year-btn").addEventListener("click",$),document.getElementById("reset-btn").addEventListener("click",U);function e(n,a){const s=document.getElementById(n);s.addEventListener("click",r=>{if(r.target.tagName==="BUTTON"){const i=r.target.id.split("-").pop();a(i),s.querySelector(".active").classList.remove("active"),r.target.classList.add("active")}})}e("corporate-policy-group",n=>f=n),e("str-policy-group",n=>I=n)});
